{{ define "main" }}

<!-- blogs -->
<section class="section">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 order-2 order-lg-1">
        <div class="row">
          <!-- blog post -->
          {{ $paginator := .Paginate ( where .Data.Pages "Type" "blog") }}
          {{ range $paginator.Pages }}
          <div class="col-sm-6 mb-5 d-flex flex-column">
            <article
              class="card rounded-0 border-bottom border-primary border-top-0 border-left-0 border-right-0 hover-shadow flex-grow-1">
              {{ $alt := "" }}
              {{ if .Params.h1 }}
                {{ $alt = .Params.h1 }}
              {{ else }}
                {{ $alt = .Title }}
              {{ end }}

              {{ $imgPath := "" }}
              {{ if .Params.image }}
                {{ $imgPath = .Params.image }}
              {{ else if .Params.bg_image }}
                {{ $imgPath = .Params.bg_image }}
              {{ else }}
                {{ $imgPath = "images/backgrounds/post-placeholder.jpg" }}
              {{ end }}

              {{/* Пытаемся найти как ресурс страницы */}}
              {{ $pageImage := .Resources.GetMatch $imgPath }}

              {{/* Если не найдено — ищем в глобальных assets */}}
              {{ $image := false }}
              {{ if not $pageImage }}
                {{ $image = resources.Get $imgPath }}
              {{ end }}

              {{ if $pageImage }}
                <img src="{{ $pageImage.Permalink }}" alt="{{ $alt }}" class="img-fluid w-100">
              {{ else if $image }}
                {{ partial "image.html" (dict "Src" $image "Alt" $alt "Class" "img-fluid w-100 rounded-0") }}
              {{ else }}
                <img src="{{ $imgPath | absURL }}" alt="{{ $alt }}" class="img-fluid w-100">
              {{ end }}

              <div class="card-body d-flex flex-column justify-content-end">
                <!-- post meta -->
                <ul class="list-inline mb-3">
                  <!-- post date -->
                  <li class="list-inline-item mr-3 ml-0"><i class="ti-calendar"></i>
                    {{ .PublishDate.Format "02.01.2006" }}</li>
                  {{/*<!-- author -->
                  <li class="list-inline-item mr-3 ml-0"><i class="ti-user"></i> <a
                      href="{{ `author/` | relLangURL }}{{ .Params.Author | urlize }}">{{ .Params.Author | title }}</a>
                  </li>*/}}
                </ul>
                <h4 class="card-title"><a href="{{ .Permalink }}">
                  {{ with .Params.h1 }}{{ . | truncate 50 }}{{ else }}{{ .Title | truncate 50 }}{{ end }}
                </a></h4>
                {{/*<p class="card-text">{{ .Summary | truncate 100 }}</p>*/}}
                <a href="{{ .Permalink }}" class="btn btn-primary btn-sm">Читать далее</a>
              </div>
            </article>
          </div>
          {{ end }}
          <div class="col-12 mt-4">
            {{ template "_internal/pagination.html" . }}
          </div>
        </div>
      </div>
      {{ partial "blog-sidebar.html" . }}
    </div>
  </div>
</section>
<!-- /blogs -->

{{ end }}
