<div class="card border-0 rounded-0 hover-shadow">
  {{ $alt := "" }}
  {{ if .Params.h1 }}
    {{ $alt = .Params.h1 }}
  {{ else }}
    {{ $alt = .Title }}
  {{ end }}

  {{ $imgPath := "" }}
  {{ if .Params.image }}
    {{ $imgPath = .Params.image }}
  {{ else if .Params.bg_image }}
    {{ $imgPath = .Params.bg_image }}
  {{ else }}
    {{ $imgPath = "images/blog/post-placeholder.jpg" }}
  {{ end }}

  {{/* Пытаемся найти как ресурс страницы */}}
  {{ $pageImage := .Resources.GetMatch $imgPath }}

  {{/* Если не найдено — ищем в глобальных assets */}}
  {{ $globalImage := false }}
  {{ if not $pageImage }}
    {{ $globalImage = resources.Get $imgPath }}
  {{ end }}

  <div class="card-img position-relative">
    {{ if $pageImage }}
      <img src="{{ $pageImage.Permalink }}" alt="{{ $alt }}" class="img-fluid w-100">
    {{ else if $globalImage }}
      {{ partial "image.html" (dict "Src" $globalImage "Alt" $alt "Class" "img-fluid w-100 rounded-0") }}
    {{ else }}
      {{/* Fallback: прямой путь (на случай, если файл в static/) */}}
      <img src="{{ $imgPath | absURL }}" alt="{{ $alt }}" class="img-fluid w-100">
    {{ end }}
  </div>

  <div class="card-body">
    <h4 class="card-title"><a href="{{ .Permalink }}">
      {{ with .Params.h1 }}{{ . | truncate 50 }}{{ else }}{{ .Title | truncate 50 }}{{ end }}
    </a></h4>
    {{/*<div class="card-text mb-4">{{ .Summary | truncate 100 }}</div>*/}}
    <a href="{{ .Permalink }}" class="btn btn-primary btn-sm">Читать далее</a>
  </div>
</div>
